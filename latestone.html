<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>万达广场第一层</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" >
<link href="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>
<style>
body { margin: 0; padding: 0; }
#map { position: absolute; top: 0; bottom: 0; width: 100%;  } //transform: rotateZ(10deg);
</style>
</head>
<body>
<div id="map"></div>
<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoiZXZlcjE1NTMiLCJhIjoiY2t1ZHV3OHpkMWUxbDJ3bG02OGdsNmdkYyJ9.zQ701fqMs1VZ17c40LJqwA';
	const bounds=[
			[106.120391,38.47812],// Southwest coordinates
			[106.173786,38.506643]// Northeast coordinates

		];
    const map = new mapboxgl.Map({
    	
        container: 'map', // container ID
        style: 'mapbox://styles/ever1553/cl06umro3000c14o5m8lrti6k', // style URL
        center: [106.14568,38.493576], // starting position [lng, lat] 106.146228,38.49376
        zoom: 16,// starting zoom
        maxBounds: bounds,
        pitch:80, //80

       
    });
	
	map.on('click', (event) => {
const features = map.queryRenderedFeatures(event.point, {
layers: ['fivefloor']
});
if (!features.length) {
return;
}
const feature = features[0];
 
const popup = new mapboxgl.Popup({ offset: [0, -15] })
.setLngLat(feature.geometry.coordinates)
.setHTML(
`<h3>${feature.properties.name}</h3><p>${feature.properties.description}</p><p><button onclick="jumptomini('${feature.properties.name}')">查看详情</button><p>`
)
.addTo(map);
});
	
function jumptomini(iname) {	
	let name =iname;
	let mydata ={name:name}; 
	let mydataStr = JSON.stringify(mydata);
        console.log("点击了一家店铺");
	const url = `/pages/shop/shop?mydataStr=${mydataStr}`;
    wx.miniProgram.navigateTo({
          url: url
        });

}
</script>
</body>
</html>